"use strict";(globalThis.webpackChunkweb=globalThis.webpackChunkweb||[]).push([[6986],{681:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"ros2/python-code","title":"02. Python Code","description":"Building and Running ROS 2 in Python","source":"@site/docs/ros2/python-code.md","sourceDirName":"ros2","slug":"/ros2/python-code","permalink":"/docs/ros2/python-code","draft":false,"unlisted":false,"editUrl":"https://github.com/AnasMehmood0/tree/main/web/docs/ros2/python-code.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"02. Python Code"},"sidebar":"tutorialSidebar","previous":{"title":"01. Architecture","permalink":"/docs/ros2/architecture"},"next":{"title":"01. Gazebo Physics","permalink":"/docs/simulation/gazebo-physics"}}');var i=s(4848),l=s(8453);const a={sidebar_position:2,sidebar_label:"02. Python Code"},o="02. Python Code",c={},t=[{value:"Building and Running ROS 2 in Python",id:"building-and-running-ros-2-in-python",level:2},{value:"Why Python for ROS 2?",id:"why-python-for-ros-2",level:2},{value:"Environment Setup",id:"environment-setup",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Workspace Setup",id:"workspace-setup",level:3},{value:"Creating a ROS 2 Python Package",id:"creating-a-ros-2-python-package",level:2},{value:"Using ros2 pkg create",id:"using-ros2-pkg-create",level:3},{value:"Understanding setup.py",id:"understanding-setuppy",level:3},{value:"Writing Python Nodes",id:"writing-python-nodes",level:2},{value:"Basic Publisher Node",id:"basic-publisher-node",level:3},{value:"Basic Subscriber Node",id:"basic-subscriber-node",level:3},{value:"Service Server",id:"service-server",level:3},{value:"Service Client",id:"service-client",level:3},{value:"Action Server",id:"action-server",level:3},{value:"Action Client",id:"action-client",level:3},{value:"Building and Running",id:"building-and-running",level:2},{value:"Build the package",id:"build-the-package",level:3},{value:"Run nodes",id:"run-nodes",level:3},{value:"Parameters in Python",id:"parameters-in-python",level:2},{value:"Declaring and using parameters",id:"declaring-and-using-parameters",level:3},{value:"Setting parameters at runtime",id:"setting-parameters-at-runtime",level:3},{value:"Launch Files in Python",id:"launch-files-in-python",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Code Organization",id:"code-organization",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Logging",id:"logging",level:3},{value:"QoS Profiles",id:"qos-profiles",level:3},{value:"Debugging Tips",id:"debugging-tips",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"02-python-code",children:"02. Python Code"})}),"\n",(0,i.jsx)(n.h2,{id:"building-and-running-ros-2-in-python",children:"Building and Running ROS 2 in Python"}),"\n",(0,i.jsx)(n.p,{children:"This chapter provides a practical guide to building and running ROS 2 applications using Python. It covers the essential steps for setting up a Python development environment for ROS 2, creating new ROS 2 packages, and writing Python nodes for publishers, subscribers, services, and actions."}),"\n",(0,i.jsx)(n.h2,{id:"why-python-for-ros-2",children:"Why Python for ROS 2?"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Advantages:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rapid prototyping"}),": Quick iteration and development"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ease of learning"}),": Simpler syntax than C++"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rich ecosystem"}),": NumPy, OpenCV, PyTorch, scikit-learn"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AI/ML integration"}),": Seamless integration with ML frameworks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Scripting"}),": Great for automation and testing"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Trade-offs:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Performance"}),": Slower than C++ for computationally intensive tasks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Real-time"}),": Less predictable timing than C++"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deployment"}),": Larger memory footprint"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When to use Python:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"High-level logic and decision making"}),"\n",(0,i.jsx)(n.li,{children:"Computer vision pipelines (OpenCV, ML models)"}),"\n",(0,i.jsx)(n.li,{children:"Planning and path finding"}),"\n",(0,i.jsx)(n.li,{children:"Rapid prototyping and research"}),"\n",(0,i.jsx)(n.li,{children:"Non-time-critical applications"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"environment-setup",children:"Environment Setup"}),"\n",(0,i.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Install ROS 2:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Ubuntu 22.04\nsudo apt update\nsudo apt install ros-humble-desktop python3-colcon-common-extensions\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Source ROS 2:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Add to ~/.bashrc"})," for automatic sourcing:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Install Python dependencies:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt install python3-pip python3-rosdep python3-argcomplete\n"})}),"\n",(0,i.jsx)(n.h3,{id:"workspace-setup",children:"Workspace Setup"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create a workspace:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src\ncd ~/ros2_ws\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build the workspace:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"colcon build\nsource install/setup.bash\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add workspace sourcing to ~/.bashrc:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'echo "source ~/ros2_ws/install/setup.bash" >> ~/.bashrc\n'})}),"\n",(0,i.jsx)(n.h2,{id:"creating-a-ros-2-python-package",children:"Creating a ROS 2 Python Package"}),"\n",(0,i.jsx)(n.h3,{id:"using-ros2-pkg-create",children:"Using ros2 pkg create"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Basic package:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create my_robot_pkg --build-type ament_python --dependencies rclpy std_msgs geometry_msgs sensor_msgs\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Package structure:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"my_robot_pkg/\n\u251c\u2500\u2500 my_robot_pkg/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 (your Python nodes go here)\n\u251c\u2500\u2500 resource/\n\u2502   \u2514\u2500\u2500 my_robot_pkg\n\u251c\u2500\u2500 test/\n\u2502   \u251c\u2500\u2500 test_copyright.py\n\u2502   \u251c\u2500\u2500 test_flake8.py\n\u2502   \u2514\u2500\u2500 test_pep257.py\n\u251c\u2500\u2500 package.xml\n\u251c\u2500\u2500 setup.py\n\u2514\u2500\u2500 setup.cfg\n"})}),"\n",(0,i.jsx)(n.h3,{id:"understanding-setuppy",children:"Understanding setup.py"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example setup.py:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\n\npackage_name = 'my_robot_pkg'\n\nsetup(\n    name=package_name,\n    version='0.0.1',\n    packages=[package_name],\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='you@example.com',\n    description='My robot package',\n    license='Apache License 2.0',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            'talker = my_robot_pkg.talker:main',\n            'listener = my_robot_pkg.listener:main',\n        ],\n    },\n)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key parts:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"packages"}),": Python packages to install"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"data_files"}),": Non-Python files (launch files, configs)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"entry_points"}),": Executable scripts (nodes)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"writing-python-nodes",children:"Writing Python Nodes"}),"\n",(0,i.jsx)(n.h3,{id:"basic-publisher-node",children:"Basic Publisher Node"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"my_robot_pkg/talker.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass TalkerNode(Node):\n    def __init__(self):\n        super().__init__('talker')\n        self.publisher = self.create_publisher(String, 'chatter', 10)\n        self.timer = self.create_timer(1.0, self.timer_callback)\n        self.counter = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.counter}'\n        self.publisher.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.counter += 1\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = TalkerNode()\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key concepts:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Node.__init__()"}),": Initialize the node with a name"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create_publisher()"}),": Create a publisher (topic, message type, QoS)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create_timer()"}),": Periodic callback"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rclpy.spin()"}),": Keep the node running"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"basic-subscriber-node",children:"Basic Subscriber Node"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"my_robot_pkg/listener.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass ListenerNode(Node):\n    def __init__(self):\n        super().__init__('listener')\n        self.subscription = self.create_subscription(\n            String,\n            'chatter',\n            self.listener_callback,\n            10\n        )\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ListenerNode()\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key concepts:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create_subscription()"}),": Subscribe to a topic"]}),"\n",(0,i.jsx)(n.li,{children:"Callback function receives messages automatically"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"service-server",children:"Service Server"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"my_robot_pkg/add_two_ints_server.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass AddTwoIntsServer(Node):\n    def __init__(self):\n        super().__init__('add_two_ints_server')\n        self.srv = self.create_service(\n            AddTwoInts,\n            'add_two_ints',\n            self.add_two_ints_callback\n        )\n        self.get_logger().info('Service ready')\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'{request.a} + {request.b} = {response.sum}')\n        return response\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = AddTwoIntsServer()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-client",children:"Service Client"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"my_robot_pkg/add_two_ints_client.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import sys\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass AddTwoIntsClient(Node):\n    def __init__(self):\n        super().__init__('add_two_ints_client')\n        self.client = self.create_client(AddTwoInts, 'add_two_ints')\n\n        # Wait for service to be available\n        while not self.client.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting...')\n\n    def send_request(self, a, b):\n        request = AddTwoInts.Request()\n        request.a = a\n        request.b = b\n\n        future = self.client.call_async(request)\n        return future\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    if len(sys.argv) != 3:\n        print('Usage: add_two_ints_client <a> <b>')\n        return\n\n    node = AddTwoIntsClient()\n    future = node.send_request(int(sys.argv[1]), int(sys.argv[2]))\n\n    rclpy.spin_until_future_complete(node, future)\n\n    try:\n        result = future.result()\n        node.get_logger().info(f'Result: {result.sum}')\n    except Exception as e:\n        node.get_logger().error(f'Service call failed: {e}')\n\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key concepts:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"wait_for_service()"}),": Block until service is available"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"call_async()"}),": Non-blocking service call"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"spin_until_future_complete()"}),": Wait for async call to finish"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"action-server",children:"Action Server"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"my_robot_pkg/fibonacci_action_server.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import time\nimport rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\nfrom action_tutorials_interfaces.action import Fibonacci\n\n\nclass FibonacciActionServer(Node):\n    def __init__(self):\n        super().__init__('fibonacci_action_server')\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'fibonacci',\n            self.execute_callback\n        )\n\n    def execute_callback(self, goal_handle):\n        self.get_logger().info('Executing goal...')\n\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        for i in range(1, goal_handle.request.order):\n            # Check if goal was cancelled\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                return Fibonacci.Result()\n\n            # Compute next Fibonacci number\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1]\n            )\n\n            self.get_logger().info(f'Feedback: {feedback_msg.sequence}')\n            goal_handle.publish_feedback(feedback_msg)\n\n            time.sleep(1)  # Simulate work\n\n        goal_handle.succeed()\n\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n        return result\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = FibonacciActionServer()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key concepts:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ActionServer"}),": Long-running tasks with feedback"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle.publish_feedback()"}),": Send progress updates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle.is_cancel_requested"}),": Check for cancellation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"goal_handle.succeed()"})," or ",(0,i.jsx)(n.code,{children:"goal_handle.canceled()"}),": Finish action"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"action-client",children:"Action Client"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"my_robot_pkg/fibonacci_action_client.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom action_tutorials_interfaces.action import Fibonacci\n\n\nclass FibonacciActionClient(Node):\n    def __init__(self):\n        super().__init__('fibonacci_action_client')\n        self._action_client = ActionClient(self, Fibonacci, 'fibonacci')\n\n    def send_goal(self, order):\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = order\n\n        self._action_client.wait_for_server()\n\n        self._send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback\n        )\n\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info('Goal rejected')\n            return\n\n        self.get_logger().info('Goal accepted')\n\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def get_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info(f'Result: {result.sequence}')\n        rclpy.shutdown()\n\n    def feedback_callback(self, feedback_msg):\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f'Feedback: {feedback.sequence}')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = FibonacciActionClient()\n    node.send_goal(10)\n    rclpy.spin(node)\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"building-and-running",children:"Building and Running"}),"\n",(0,i.jsx)(n.h3,{id:"build-the-package",children:"Build the package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select my_robot_pkg\nsource install/setup.bash\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build specific package only:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"colcon build --packages-select my_robot_pkg\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build with verbose output:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"colcon build --packages-select my_robot_pkg --event-handlers console_direct+\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-nodes",children:"Run nodes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Talker:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg talker\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Listener (in another terminal):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg listener\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Service server:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg add_two_ints_server\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Service client:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg add_two_ints_client 3 5\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Action server:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg fibonacci_action_server\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Action client:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg fibonacci_action_client\n"})}),"\n",(0,i.jsx)(n.h2,{id:"parameters-in-python",children:"Parameters in Python"}),"\n",(0,i.jsx)(n.h3,{id:"declaring-and-using-parameters",children:"Declaring and using parameters"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"my_robot_pkg/parameter_node.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\n\nclass ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('my_string', 'Hello')\n        self.declare_parameter('my_int', 42)\n        self.declare_parameter('my_double', 3.14)\n        self.declare_parameter('my_bool', True)\n\n        # Get parameter values\n        my_string = self.get_parameter('my_string').value\n        my_int = self.get_parameter('my_int').value\n\n        self.get_logger().info(f'String: {my_string}, Int: {my_int}')\n\n        # Set up parameter callback\n        self.add_on_set_parameters_callback(self.parameter_callback)\n\n    def parameter_callback(self, params):\n        for param in params:\n            self.get_logger().info(f'Parameter {param.name} changed to {param.value}')\n        return rclpy.parameter.SetParametersResult(successful=True)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ParameterNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"setting-parameters-at-runtime",children:"Setting parameters at runtime"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Command line:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ros2 run my_robot_pkg parameter_node --ros-args -p my_string:="ROS 2" -p my_int:=100\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"From another terminal:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ros2 param set /parameter_node my_string "New Value"\nros2 param get /parameter_node my_string\nros2 param list /parameter_node\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Using YAML file:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# config/params.yaml\nparameter_node:\n  ros__parameters:\n    my_string: "From YAML"\n    my_int: 999\n    my_double: 2.71\n    my_bool: false\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Load from YAML:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg parameter_node --ros-args --params-file config/params.yaml\n"})}),"\n",(0,i.jsx)(n.h2,{id:"launch-files-in-python",children:"Launch Files in Python"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["File: ",(0,i.jsx)(n.code,{children:"launch/my_launch.py"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='my_robot_pkg',\n            executable='talker',\n            name='talker',\n            output='screen',\n        ),\n        Node(\n            package='my_robot_pkg',\n            executable='listener',\n            name='listener',\n            output='screen',\n        ),\n    ])\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Run launch file:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 launch my_robot_pkg my_launch.py\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Advanced launch with parameters:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\nimport os\n\n\ndef generate_launch_description():\n    config = os.path.join(\n        get_package_share_directory('my_robot_pkg'),\n        'config',\n        'params.yaml'\n    )\n\n    return LaunchDescription([\n        Node(\n            package='my_robot_pkg',\n            executable='parameter_node',\n            name='param_node',\n            parameters=[config],\n            output='screen',\n        ),\n    ])\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Update setup.py to include launch files:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import os\nfrom glob import glob\n\nsetup(\n    # ... other fields ...\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n        (os.path.join('share', package_name, 'launch'), glob('launch/*.py')),\n        (os.path.join('share', package_name, 'config'), glob('config/*.yaml')),\n    ],\n)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"code-organization",children:"Code Organization"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Use classes for nodes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class MyNode(Node):\n    def __init__(self):\n        super().__init__('my_node')\n        # Initialize here\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Separate logic from ROS communication:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class MyAlgorithm:\n    def process(self, data):\n        # Pure Python logic\n        return result\n\nclass MyNode(Node):\n    def __init__(self):\n        super().__init__('my_node')\n        self.algorithm = MyAlgorithm()\n\n    def callback(self, msg):\n        result = self.algorithm.process(msg.data)\n        # Publish result\n"})}),"\n",(0,i.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Graceful shutdown:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        node.get_logger().info('Shutting down')\n    except Exception as e:\n        node.get_logger().error(f'Error: {e}')\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Service call error handling:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"try:\n    result = future.result()\nexcept Exception as e:\n    self.get_logger().error(f'Service failed: {e}')\n"})}),"\n",(0,i.jsx)(n.h3,{id:"logging",children:"Logging"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Log levels:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"self.get_logger().debug('Debug message')\nself.get_logger().info('Info message')\nself.get_logger().warn('Warning message')\nself.get_logger().error('Error message')\nself.get_logger().fatal('Fatal message')\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Set log level:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_pkg talker --ros-args --log-level debug\n"})}),"\n",(0,i.jsx)(n.h3,{id:"qos-profiles",children:"QoS Profiles"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Custom QoS:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\n\nqos_profile = QoSProfile(\n    reliability=ReliabilityPolicy.BEST_EFFORT,\n    history=HistoryPolicy.KEEP_LAST,\n    depth=10\n)\n\nself.publisher = self.create_publisher(String, 'topic', qos_profile)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"debugging-tips",children:"Debugging Tips"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Check running nodes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 node list\nros2 node info /talker\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Monitor topics:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 topic list\nros2 topic echo /chatter\nros2 topic hz /chatter\nros2 topic bw /chatter\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Inspect messages:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 interface show std_msgs/msg/String\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Service debugging:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ros2 service list\nros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 3, b: 5}"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameter debugging:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 param list\nros2 param describe /talker use_sim_time\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Use rqt tools:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"rqt_graph  # Visualize nodes and topics\nrqt_console  # View logs\nrqt_plot  # Plot numeric data\n"})}),"\n",(0,i.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Python is ideal for rapid development and AI/ML integration in ROS 2"}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"ros2 pkg create"})," with ",(0,i.jsx)(n.code,{children:"--build-type ament_python"})," to create packages"]}),"\n",(0,i.jsx)(n.li,{children:"Entry points in setup.py define executable nodes"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rclpy"})," provides Node, Publisher, Subscriber, Service, Action APIs"]}),"\n",(0,i.jsx)(n.li,{children:"Parameters enable runtime configuration"}),"\n",(0,i.jsx)(n.li,{children:"Launch files orchestrate multiple nodes"}),"\n",(0,i.jsx)(n.li,{children:"Follow best practices: classes, error handling, logging, QoS"}),"\n",(0,i.jsx)(n.li,{children:"Use ROS 2 CLI and rqt tools for debugging"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["rclpy API Documentation: ",(0,i.jsx)(n.a,{href:"https://docs.ros2.org/latest/api/rclpy/",children:"https://docs.ros2.org/latest/api/rclpy/"})]}),"\n",(0,i.jsxs)(n.li,{children:["ROS 2 Python Tutorials: ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html",children:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html"})]}),"\n",(0,i.jsxs)(n.li,{children:["ament_python Documentation: ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/How-To-Guides/Ament-CMake-Python-Documentation.html",children:"https://docs.ros.org/en/humble/How-To-Guides/Ament-CMake-Python-Documentation.html"})]}),"\n",(0,i.jsxs)(n.li,{children:["QoS Guide: ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html",children:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var r=s(6540);const i={},l=r.createContext(i);function a(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);